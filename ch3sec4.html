
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3.4. Décodage MAP symbole &#8212; Codage et détection avancés</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystyle.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="4. Concaténation de codes en treillis : Turbo-codes" href="ch4intro.html" />
    <link rel="prev" title="3.3. Décodage par Maximum de Vraisemblance" href="ch3sec3.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/N7solo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Codage et détection avancés</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Bienvenue au cours de codage et détection avancés.
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="ch1intro.html">
   1. Introduction à la théorie de l’information
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ch1sec1.html">
     1.3. Mesure de l’information : notion d’entropie
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch1sec2.html">
     1.4. Information mutuelle
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch1sec3.html">
     1.5. Capacité d’un canal de transmission
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="PlayWithCapacity.html">
     1.6. Exemples de calcul de la capacité en Matlab
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch1sec4.html">
     1.7. Théorème du codage canal
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="ch2intro.html">
   2. Codage de canal - critère de décodage
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ch2sec1.html">
     2.1. Codes en blocs linéaires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch2sec2.html">
     2.2. Critères de décodage séquence
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch2sec3.html">
     2.3. Notions d’information souple
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch2sec4.html">
     2.4. Décodage MAP bit/symbole pour un code en bloc
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch2sec5.html">
     2.5. Démodulation MAP bit et systèmes BICM.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="BICM.html">
     2.6. Exemple Matlab : Systèmes BICM
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="ch3intro.html">
   3. Codes convolutifs : structure et décodage
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="ch3sec1.html">
     3.1. Un exemple: le code
     <span class="math notranslate nohighlight">
      \((5,7)_8\)
     </span>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch3sec2.html">
     3.2. Représentations
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch3sec3.html">
     3.3. Décodage par Maximum de Vraisemblance
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3.4. Décodage MAP symbole
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="ch4intro.html">
   4. Concaténation de codes en treillis : Turbo-codes
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ch4sec1.html">
     4.1. Turbo-codes parallèles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch4sec2.html">
     4.2. Turbo-codes série
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="ch5intro.html">
   5. Codes LDPC
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="ch5sec1.html">
     5.1. Codes LDPC binaires
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch5sec2.html">
     5.2. Décodage par propagation de croyance
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="ch5sec3.html">
     5.3. Encodage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="biblio.html">
   6. Bibliographie
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/executablebooks/jupyter-book"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fch3sec4.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/ch3sec4.md"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.md</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#critere-map-bit">
   3.4.1. Critère MAP bit
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithme-bcjr-forward-backward">
   3.4.2. Algorithme BCJR/Forward-Backward
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notations">
     3.4.2.1. Notations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#llr-map-revisite">
     3.4.2.2. LLR MAP revisité
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#factorisation-de-p-s-s-bf-y">
     3.4.2.3. Factorisation de
     <span class="math notranslate nohighlight">
      \(p(s', s, { \bf y})\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recursions-forward-backward">
     3.4.2.4. Récursions forward-backward
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calcul-des-probabilites-de-transitions">
     3.4.2.5. Calcul des probabilités de transitions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialisation-des-recursions-forward-backward">
     3.4.2.6. Initialisation des récursions forward-backward
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probabilite-des-etats">
     3.4.2.7. Probabilité des états
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resume">
     3.4.2.8. Résumé
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithme-bcjr-dans-le-domaine-logarithmique">
   3.4.3. Algorithme BCJR dans le domaine logarithmique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recursions-dans-le-domaine-logarithmique">
     3.4.3.1. Récursions dans le domaine logarithmique
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calcul-de-l-u-n">
     3.4.3.2. Calcul de
     <span class="math notranslate nohighlight">
      \(L(u_n)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#l-operateur-max">
     3.4.3.3. L’opérateur
     <span class="math notranslate nohighlight">
      \(\max^*\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algorithme-log-map">
     3.4.3.4. Algorithme Log-MAP
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algorithme-max-log-map">
     3.4.3.5. Algorithme Max-Log-MAP
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#log-map-log-bcjr-cas-gaussien">
     3.4.3.6. Log-MAP (log-BCJR) : cas Gaussien
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Décodage MAP symbole</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#critere-map-bit">
   3.4.1. Critère MAP bit
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithme-bcjr-forward-backward">
   3.4.2. Algorithme BCJR/Forward-Backward
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#notations">
     3.4.2.1. Notations
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#llr-map-revisite">
     3.4.2.2. LLR MAP revisité
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#factorisation-de-p-s-s-bf-y">
     3.4.2.3. Factorisation de
     <span class="math notranslate nohighlight">
      \(p(s', s, { \bf y})\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recursions-forward-backward">
     3.4.2.4. Récursions forward-backward
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calcul-des-probabilites-de-transitions">
     3.4.2.5. Calcul des probabilités de transitions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialisation-des-recursions-forward-backward">
     3.4.2.6. Initialisation des récursions forward-backward
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#probabilite-des-etats">
     3.4.2.7. Probabilité des états
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resume">
     3.4.2.8. Résumé
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#algorithme-bcjr-dans-le-domaine-logarithmique">
   3.4.3. Algorithme BCJR dans le domaine logarithmique
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#recursions-dans-le-domaine-logarithmique">
     3.4.3.1. Récursions dans le domaine logarithmique
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calcul-de-l-u-n">
     3.4.3.2. Calcul de
     <span class="math notranslate nohighlight">
      \(L(u_n)\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#l-operateur-max">
     3.4.3.3. L’opérateur
     <span class="math notranslate nohighlight">
      \(\max^*\)
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algorithme-log-map">
     3.4.3.4. Algorithme Log-MAP
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algorithme-max-log-map">
     3.4.3.5. Algorithme Max-Log-MAP
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#log-map-log-bcjr-cas-gaussien">
     3.4.3.6. Log-MAP (log-BCJR) : cas Gaussien
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="decodage-map-symbole">
<h1><span class="section-number">3.4. </span>Décodage MAP symbole<a class="headerlink" href="#decodage-map-symbole" title="Permalink to this headline">#</a></h1>
<section id="critere-map-bit">
<h2><span class="section-number">3.4.1. </span>Critère MAP bit<a class="headerlink" href="#critere-map-bit" title="Permalink to this headline">#</a></h2>
<p>On s’intéresse ici au décodage des codes convolutifs suivant un critère MAP symbole, le symbole étant ici un bit. Ce critère diffère du MAP séquence ou ML. L’idée ici est de calculer la probabilité a posteriori d’un bit d’information (ou codé comme on le verra après) sachant l’ensemble de observations. Ceci est donné par la définition suivante si
on considère une séquence de bits d’information <span class="math notranslate nohighlight">\(u_n \in \{ 0,1 \}\)</span> de taille <span class="math notranslate nohighlight">\(K\)</span></p>
<div class="proof definition admonition" id="definition-0">
<p class="admonition-title"><span class="caption-number">Definition 3.5 </span> (Critère MAP bit)</p>
<section class="definition-content" id="proof-content">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\hat{u}_n &amp;=&amp; \mathrm{arg} \max_{u_n}{p(u_n | {\bf y}) } \nonumber \\
&amp;=&amp; \frac{1-\mathrm{signe}(L(u_n))}{2}
\end{aligned}\end{split}\]</div>
<p>avec</p>
<div class="math notranslate nohighlight">
\[L(u_n)=\log{\left[\frac{p(u_n = 0 | {\bf y})}{p(u_n = 1 | {\bf y})}\right]}\]</div>
</section>
</div><p>La quantité <span class="math notranslate nohighlight">\(L(u_n)\)</span> est ce que l’on appelle le LLR (<em>Log-Likelihood Ratio</em>) associé au bit <span class="math notranslate nohighlight">\(u_n\)</span>.</p>
<p>Le critère est une conséquence du fait que l’on considère une variable binaire. En effet, si on considère le bit <span class="math notranslate nohighlight">\(u_n\)</span>, alors le test de
décision statistique binaire associé donne</p>
<div class="math notranslate nohighlight">
\[\hat{u}_n = \mathrm{arg} \max_{u_n}{p(u_n | {\bf y}) }=0\]</div>
<p>si</p>
<div class="math notranslate nohighlight">
\[p(u_n=0 | {\bf y}) &gt; p(u_n=1 | {\bf y}).\]</div>
<p>Par passage au <span class="math notranslate nohighlight">\(\log\)</span> et définition du LLR associé à <span class="math notranslate nohighlight">\(u_n\)</span> on obtient alors <span class="math notranslate nohighlight">\(L(u_n)&gt;0\)</span>. De la même manière, on aura <span class="math notranslate nohighlight">\(\hat{u}_n =1\)</span> si
<span class="math notranslate nohighlight">\(L(u_n)&lt;0\)</span>. On a donc la relation <span class="math notranslate nohighlight">\(\mathrm{signe}(L(u_n))=1-2 u_n\)</span> qui nous définit un mapping bijectif entre le signe du LLR et la valeur
binaire. Ce mapping bijectif correspond d’ailleurs à un mapping de type BPSK : <span class="math notranslate nohighlight">\(\{`0' \leftrightarrow +1, `1' \leftrightarrow -1 \}\)</span>. Compte
tenu de cette relation directe, il est souvent plus commode de directement considérer la version “mappée/modulé” du bit (cas des
canaux souples), de sorte que l’on considérera de manière indifférenciée <span class="math notranslate nohighlight">\(u_n=0/1\)</span> et <span class="math notranslate nohighlight">\(u_n=\pm 1\)</span> dès lors le contexte en suffisamment clair.
Ainsi, on pourra adopter la règle MAP suivante</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\hat{u}_n &amp;=\mathrm{arg} \max_{u_n}{p(u_n | {\bf y}) } \nonumber \\
&amp;= \mathrm{signe}(L(u_n))
\end{aligned}\end{split}\]</div>
<p>Le LLR associé à <span class="math notranslate nohighlight">\(u_n\)</span> peut être associé à une mesure de fiabilité de la décision. En effet, <span class="math notranslate nohighlight">\(\mathrm{signe}(L(u_n))\)</span> est identifiable à une
décision “dure” du bit à laquelle on peut associer une mesure de fiabilité de cette décision grâce à <span class="math notranslate nohighlight">\(|L(u_n)|\)</span>. Plus cette dernière
valeur est élevée, plus la décision est fiable. On peut également noter que la connaisance du LLR permet de remonter facilement aux probabilité
en remarquant que</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
p(u_n =0 | {\bf y}) + p(u_n =1 | {\bf y})= 1 \\
\nonumber \\
L(u_n) = \log{\left(\frac{p(u_n = 0 | {\bf y})}{p(u_n = 1 | {\bf y})}\right)}
\end{aligned}\end{split}\]</div>
<p>On obtient alors les relations suivantes</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
p(u_n =0 | {\bf y}) &amp; = &amp; \frac{e^{L(u_n)}}{1+e^{L(u_n)}} \\
\nonumber \\
p(u_n =1 | {\bf y}) &amp; = &amp; \frac{1}{1+e^{L(u_n)} }
\end{aligned}\end{split}\]</div>
<p>La quantité <span class="math notranslate nohighlight">\(L(u_n)\)</span> est souvent appelée <em>information souple</em>. Un algorithme qui fournit en sortie des informations homogènes à des LLRs
(ou symboles bruités) est appelé <em>algorithme à sorties souples (Soft Outputs, SO)</em> par opposition à des algorithmes qui fournissent une
version décidée des symboles dénommés <em>algorithme à sorties dures (Hard Outputs, HO)</em>. Par analogie, si les entrées sont des symboles décidés,
on parle d’algorithem à entrées dures (Hard Input, HI) par opposition à des algorithmes à entrées souples (Soft Inputs, SI) prenant en compte
des symboles bruités ou des entrèes représentant des statistiques suffisantes.</p>
</section>
<section id="algorithme-bcjr-forward-backward">
<h2><span class="section-number">3.4.2. </span>Algorithme BCJR/Forward-Backward<a class="headerlink" href="#algorithme-bcjr-forward-backward" title="Permalink to this headline">#</a></h2>
<section id="notations">
<h3><span class="section-number">3.4.2.1. </span>Notations<a class="headerlink" href="#notations" title="Permalink to this headline">#</a></h3>
<p>Dans la suite, nous adopterons les notations suivantes:</p>
<ul class="simple">
<li><p>Sans perte de généralité, et pour simplifier l’exposition, on considérera un code de rendement à <span class="math notranslate nohighlight">\(1\)</span> entrée et <span class="math notranslate nohighlight">\(nc\)</span> sorties. Le rendement initiale avant fermeture est donc <span class="math notranslate nohighlight">\(R_0=1/n_c\)</span>.</p></li>
<li><p>La longueur totale de treillis considéré est <span class="math notranslate nohighlight">\(L=K+Nf\)</span> (<span class="math notranslate nohighlight">\(K\)</span> bits d’info. + <span class="math notranslate nohighlight">\(Nf\)</span> bits de fermeture).</p></li>
<li><p>Pour simplifier l’écriture, on considérera des notations vectorielles. Ainsi le mot de code émis est <span class="math notranslate nohighlight">\({\bf c}=[c_1, c_2, \cdots c_L]\)</span> avec
<span class="math notranslate nohighlight">\(c_k=[c_k^{(1)}, c_k^{(2)}, \cdots, c_k^{(n_c)}]\)</span> le label codé émis de bits codés à l’instant <span class="math notranslate nohighlight">\(k\)</span>. De même, on a le vecteur de symboles
bruités reçus noté par <span class="math notranslate nohighlight">\({\bf y}=[y_1, y_2, \ldots y_L]\)</span> avec <span class="math notranslate nohighlight">\(y_k=[y_k^{(1)}, y_k^{(2)}, \ldots, y_k^{(n_c)}]\)</span>. <span class="math notranslate nohighlight">\(y_k\)</span> est le
symbole reçu issu d’un canal à entrées binaires et sans mémoire. Si le canal est additif, on aura <span class="math notranslate nohighlight">\(y_k^{(j)}=c_k^{(j)}+b_k^{(j)}\)</span>, en
supposant <span class="math notranslate nohighlight">\(c_k^{(j)}\)</span> la version modulée du bit codé. On notera <span class="math notranslate nohighlight">\({\bf y}_{k}^{l}=[y_k, y_{k+1}, \cdots y_{l-1}, y_{l}]\)</span> la suite
d’observations entre les sections <span class="math notranslate nohighlight">\(k\)</span> et <span class="math notranslate nohighlight">\(l\)</span>.</p></li>
</ul>
</section>
<section id="llr-map-revisite">
<h3><span class="section-number">3.4.2.2. </span>LLR MAP revisité<a class="headerlink" href="#llr-map-revisite" title="Permalink to this headline">#</a></h3>
<p>Dans le cadre des codes convolutifs, on va maintenant dériver l’expression du critère MAP bit qui permet de calculer le critère</p>
<p>C’est un algorithme de type bloc qui considère un traitement par bloc des données. Pour ceci, on utilisera la représentation markovienne du
code à l’aide son espace d’état. On notera par <span class="math notranslate nohighlight">\(s_n\)</span> l’état d’arrivée du codeur quand le bit <span class="math notranslate nohighlight">\(u_n\)</span> a été émis. On a alors une correspondance
bijective : <span class="math notranslate nohighlight">\(u_n \leftrightarrow (s_{n-1},s_n)\)</span>. En parliculier, on aura besoin de définir les ensembles suivants:</p>
<ol>
<li><p>Ensemble des transitions associées à <span class="math notranslate nohighlight">\(u_n=+1\)</span> sur une section de treillis :</p>
<div class="math notranslate nohighlight">
\[\mathcal{S}^{+} = \{ (s',s) \; \mathrm{ o\grave{u} } \; (s_{n-1}=s') \mapsto (s_{n}=s)| u_n=+1 \}\]</div>
</li>
<li><p>Ensemble des transitions associées à <span class="math notranslate nohighlight">\(u_n=-1\)</span> sur une section de treillis :</p>
<div class="math notranslate nohighlight">
\[\mathcal{S}^{-} = \{ (s',s) \; \mathrm{ o\grave{u} } \; (s_{n-1}=s') \mapsto (s_{n}=s)| u_n=-1 \}\]</div>
</li>
</ol>
<p>On peut alors dériver l’expression du LLR <span class="math notranslate nohighlight">\(L(u_n)\)</span> associé à la décision MAP comme suit</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
L(u_n)&amp;=\log{\left[\frac{p(u_n = +1 | {\bf y})}{p(u_n = -1 | {\bf y})}\right]} \nonumber \\
&amp;\nonumber \\
&amp;=\log{\left[\frac{p(u_n = +1 , {\bf y})}{p(u_n = -1 , {\bf y})}\right]} \nonumber
\end{aligned}\end{split}\]</div>
<p>On peut noter alors que pour <span class="math notranslate nohighlight">\(u_n=+1\)</span> (résultat similaire pour <span class="math notranslate nohighlight">\(u_n=-1\)</span>), on a</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
p(u_n = +1, {\bf y})&amp;= \sum_{s'}\sum_s {p(u_n = +1, s_{n-1}=s', s_{n}=s, { \bf y})}  \nonumber \\ 
&amp;=\sum_{\mathcal{S}^{+}}{p(s_{n-1}=s', s_{n}=s, { \bf y})} \nonumber \\
\end{aligned}\end{split}\]</div>
<p>et donc au final, on peut écrire</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
L(u_n)&amp;=\log{\left[\frac{ \sum_{\mathcal{S}^{+}}{p(s_{n-1}=s', s_{n}=s, { \bf y})}}{\sum_{\mathcal{S}^{-}}{p(s_{n-1}=s', s_{n}=s, { \bf y})}}\right]}
\end{aligned}\]</div>
<p>Il nous reste alors à calculer le terme <span class="math notranslate nohighlight">\(p(s_{n-1}=s', s_{n}=s, { \bf y})\)</span>.</p>
</section>
<section id="factorisation-de-p-s-s-bf-y">
<h3><span class="section-number">3.4.2.3. </span>Factorisation de <span class="math notranslate nohighlight">\(p(s', s, { \bf y})\)</span><a class="headerlink" href="#factorisation-de-p-s-s-bf-y" title="Permalink to this headline">#</a></h3>
<p>Par application de la règle de Bayes et en utilisant les propriétés markoviennes du code, on peut écrire la factorisation suivante</p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
p(s_{n-1}=s', s_{n}=s, { \bf y})&amp;=\alpha_{n-1}(s') \gamma_n(s',s) \beta_{n}(s) 
\end{aligned}\]</div>
<p>où</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\alpha_{n}(s) &amp;= p(s_n=s, {\bf y}_1^n) \nonumber\\
\beta_{n}(s) &amp;= p({\bf y}_{n+1}^L|s_n=s) \nonumber\\
\gamma_n(s',s)&amp;= p(s_n=s, y_n|s_{n-1}=s')\nonumber
\end{aligned}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(\alpha_{n}(s)\)</span> représente alors la probabilité conjointe d’être dans l’état <span class="math notranslate nohighlight">\(s_n=s\)</span> et d’avoir les observations associées aux <span class="math notranslate nohighlight">\(n\)</span> premières
trnasitions du treillis (information du passé). cette quantité est souvent appelée <em>métrique forward</em>. De la même manière, <span class="math notranslate nohighlight">\(\beta_{n}(s)\)</span>
représente alors la probabilité d’observer les les observations futures sachant l’état <span class="math notranslate nohighlight">\(s_n=s\)</span> (information liée aux observations futures).
cette quantité est souvent appelée <em>métrique backward</em>. Enfin, <span class="math notranslate nohighlight">\(\gamma_n(s',s)\)</span> souvent appelé prbabilité/métrique de transition
correspond à la vraisemblance liée à l’obervation courante. Elle dépend explicitement du modèle de canal. Ainsi, de manière très grossière, le
calcul du MAP pour une section <span class="math notranslate nohighlight">\(n\)</span> du treillis (on veut décdier le bit <span class="math notranslate nohighlight">\(u_n\)</span>) se réalise par le produit de probabilités associées à une
information du passé du future et de l’observation courante. On va voir maintenant comment calculer efficacement ces quantités.</p>
</section>
<section id="recursions-forward-backward">
<h3><span class="section-number">3.4.2.4. </span>Récursions forward-backward<a class="headerlink" href="#recursions-forward-backward" title="Permalink to this headline">#</a></h3>
<p>En utilisant les mêmes ressorts que précédemment, on peut montrer facilement que l’on a les relations suivantes</p>
<ol>
<li><p><em><strong>Passe Forward :</strong></em></p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    \alpha_{n}(s) &amp;=&amp; \sum_{s'}{\gamma_n(s',s)\alpha_{n-1}(s')}
    \end{aligned}\]</div>
<p>Le calcul de <span class="math notranslate nohighlight">\(\alpha_{n}(s)\)</span> se réalise donc de manière récursive suivant les indices de temps croissants (Phase forward/aller). Le
calcul se réalise sur les transitions possibles entre les états de départ <span class="math notranslate nohighlight">\(s_{n-1}\)</span> et d’arrivée <span class="math notranslate nohighlight">\(s_n\)</span>.</p>
</li>
<li><p><em><strong>Passe Backward :</strong></em></p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    \beta_{n-1}(s') &amp;=&amp; \sum_{s}{\gamma_n(s',s)\beta_{n}(s)}
    \end{aligned}\]</div>
<p>Le calcul de <span class="math notranslate nohighlight">\(\beta_{n}(s)\)</span> se réalise donc de manière récursive suivant les indices de temps décroissants (Phase backward/retour).
Le calcul se réalise sur les transitions possibles entre les états de départ <span class="math notranslate nohighlight">\(s_{n+1}\)</span> et d’arrivée <span class="math notranslate nohighlight">\(s_{n}\)</span>.</p>
</li>
</ol>
</section>
<section id="calcul-des-probabilites-de-transitions">
<h3><span class="section-number">3.4.2.5. </span>Calcul des probabilités de transitions<a class="headerlink" href="#calcul-des-probabilites-de-transitions" title="Permalink to this headline">#</a></h3>
<p>Il ne reste plus qu’à calculer les propabiltés de transition. De manière directe, le calcul donne</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\gamma_n(s',s)&amp;= p(s_n=s, y_n|s_{n-1}=s') \\
&amp; =  p(y_n|s',s) . p(s|s')\\
\end{aligned}\end{split}\]</div>
<p>avec</p>
<div class="math notranslate nohighlight">
\[\begin{split}p(s|s')=\left \lbrace \begin{array}{cl} 0 &amp;, \mbox{ si } \{s' \rightarrow s\} \mbox{ non valide}\\ \pi(u_n)&amp;, \mbox{ sinon } \end{array}\right.\end{split}\]</div>
<p>On peut alors écrire</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\gamma_n(s',s)&amp;=&amp; p(y_n|c_n(s',s)) \pi(u_n) \mathbb{1}_{s' \rightarrow s} \nonumber \\
&amp;=&amp; \prod_{m=1}^{n_c}{p(y_n^{(m)}|c_n^{(m)(s',s)})} \pi(u_n) \mathbb{1}_{s' \rightarrow s}
\end{aligned}\end{split}\]</div>
<p>avec <span class="math notranslate nohighlight">\(\pi(u_n)\)</span> la probabilité à priori de <span class="math notranslate nohighlight">\(u_n\)</span> et <span class="math notranslate nohighlight">\(c_n(s',s)\)</span> les bits associés à l’étiquette <span class="math notranslate nohighlight">\((s' \rightarrow s).\)</span> La dernière inégalité est obtenue en considérant que le canal est un canal binaire sans mémoire.</p>
<p>Dans le cas où l’on considère une transmission codée sur un canal sans mémoire additif Gaussien, on a</p>
<div class="proof example admonition" id="example-1">
<p class="admonition-title"><span class="caption-number">Example 3.3 </span> (Cas Gaussien)</p>
<section class="example-content" id="proof-content">
<div class="math notranslate nohighlight">
\[\forall n, \forall m \in \{1, \cdots, n_c \}, \;y_n^{(m)}=c_n^{(m)}+b_n^{(m)}, b_n^{(m)} \sim \mathcal{N}(0, \sigma_b^2)\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\Large \gamma_n(s',s)&amp;=  \prod_{m=1}^{n_c}{p(y_n^{(m)}|c_n^{(m)}(s',s))} \nonumber \\
&amp;=\frac{1}{\left(\sqrt{2 \pi \sigma_b^2} \right)^{n_c}} \exp{\left(-\frac{\sum_{m=1}^{n_c}{|y_n^{(m)}-c_n^{(m)}(s',s)|^2}}{2 \sigma_b^2}\right)} \pi(u_n) \mathbb{1}_{s' \rightarrow s} \nonumber
\end{aligned}\end{split}\]</div>
</section>
</div></section>
<section id="initialisation-des-recursions-forward-backward">
<h3><span class="section-number">3.4.2.6. </span>Initialisation des récursions forward-backward<a class="headerlink" href="#initialisation-des-recursions-forward-backward" title="Permalink to this headline">#</a></h3>
<p>Les phases forward backward nécessite une initialisation pour les états <span class="math notranslate nohighlight">\(\alpha_{0}(s)\)</span> et <span class="math notranslate nohighlight">\(\beta_{L}(s)\)</span>. Cette initialisation dépend du type de fermeture appliquée au code convolutif.</p>
<ol>
<li><p><strong>Sans Fermeture de treillis :</strong></p>
<p>Dans ce mode, on peut suppoeser le codeur initialisé dans l’état <span class="math notranslate nohighlight">\(s_0=0\)</span>. Seul un état est donc possible. Comme il n’y a pas de
fermeture de treillis, tous les états finaux sont donc équi-probables. Dans ce cadre, il la mémoire du code est la mémoire
du code <span class="math notranslate nohighlight">\(\nu\)</span>, on obtient alors</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    \alpha_{0}(0) = 1 &amp;,&amp; \alpha_{0}(s) = 0 \; \mathrm{sinon} \nonumber\\
    &amp;&amp;\nonumber \\
    \beta_{L}(0) = 1/2^{\nu} &amp;,&amp; \forall s \nonumber
    \end{aligned}\end{split}\]</div>
</li>
<li><p><strong>Fermeture de treillis :</strong></p>
<p>Dans ce cas, les états de départs et d’arrivée sont connus (on suppose qu’ils sont égaux à <span class="math notranslate nohighlight">\(s_0=0\)</span>).</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    \alpha_{0}(0) = 1 &amp;,&amp; \alpha_{0}(s) = 0 \; \mathrm{sinon} \nonumber\\
    &amp;&amp;\nonumber \\
    \beta_{L}(0) = 1 &amp;,&amp; \beta_{L}(s) = 0 \; \mathrm{sinon} \nonumber
    \end{aligned}\end{split}\]</div>
</li>
</ol>
</section>
<section id="probabilite-des-etats">
<h3><span class="section-number">3.4.2.7. </span>Probabilité des états<a class="headerlink" href="#probabilite-des-etats" title="Permalink to this headline">#</a></h3>
<p>On peut également accéder à la probabilité des états, relation utile dans certains (codeur à faible nombre d’état) car elle évite
l’utilisation d’un calcul directe de <span class="math notranslate nohighlight">\(p(s_{n-1}=s', s_{n}=s, { \bf y})\)</span>.
En effet, un calcul rapide permet d’écrire</p>
<div class="math notranslate nohighlight">
\[\lambda_n(s)=p(s, {\bf y})=\alpha_{n}(s) \beta_n(s), \forall s,n\]</div>
</section>
<section id="resume">
<h3><span class="section-number">3.4.2.8. </span>Résumé<a class="headerlink" href="#resume" title="Permalink to this headline">#</a></h3>
<p>L’algorithme complet peut alors être énoncé comme suit</p>
<div class="proof algorithm admonition" id="algorithm-2">
<p class="admonition-title"><span class="caption-number">Algorithm 3.2 </span> (Algorithme BCJR)</p>
<section class="algorithm-content" id="proof-content">
<ol class="simple">
<li><p><strong>Initialisation (avec fermeture treillis):</strong></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    \alpha_{0}(0) = 1 &amp;,&amp; \alpha_{0}(s) = 0 \; \mathrm{sinon} \\
    \nonumber \\
    \beta_{L}(0) = 1 &amp;,&amp; \beta_{L}(s) = 0 \; \mathrm{sinon}
    \end{aligned}\end{split}\]</div>
<ol>
<li><p><strong>Phase forward-backward :</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    \forall n=1, \cdots, L-1, \; \alpha_{n}(s) &amp;=&amp; \sum_{s'}{\gamma_n(s',s)\alpha_{n-1}(s')} \\
    \forall n=L-1, \cdots, 1, \;\beta_{n-1}(s') &amp;=&amp; \sum_{s}{\gamma_n(s',s)\beta_{n}(s)}
    \end{aligned}\end{split}\]</div>
</li>
<li><p><strong>Calcul de <span class="math notranslate nohighlight">\(L(u_n)\)</span>:</strong> <span class="math notranslate nohighlight">\(\forall n=1, \cdots, K\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{aligned}
    L(u_n)&amp;=&amp;\log{\left[\frac{ \sum_{\mathcal{S}^{+}}{p(s_{n-1}=s', s_{n}=s, { \bf y})}}{\sum_{\mathcal{S}^{-}}{p(s_{n-1}=s', s_{n}=s, { \bf y})}}\right]}
    \end{aligned}\]</div>
</li>
</ol>
</section>
</div></section>
</section>
<section id="algorithme-bcjr-dans-le-domaine-logarithmique">
<h2><span class="section-number">3.4.3. </span>Algorithme BCJR dans le domaine logarithmique<a class="headerlink" href="#algorithme-bcjr-dans-le-domaine-logarithmique" title="Permalink to this headline">#</a></h2>
<p>Pour des raisons pratiques, il est souvent plus comode d’exprimer l’algorithme BCJR dans le domaine logarithmique. Si on redéfinit les
équations précédentes en considérant le logarithme des quantités précédentes, on se retrouve à devoir dériver les récurrence pour les
nouvelles quantités données par</p>
<div class="math notranslate nohighlight">
\[\tilde{\alpha}_n(s)\triangleq \log{(\alpha_n(s))}\]</div>
<div class="math notranslate nohighlight">
\[\tilde{\beta}_{n}(s) \triangleq \log{(\beta_n(s))}\]</div>
<div class="math notranslate nohighlight">
\[\tilde{\gamma}_n(s',s)\triangleq \log{(\gamma_n(s',s))}\]</div>
<section id="recursions-dans-le-domaine-logarithmique">
<h3><span class="section-number">3.4.3.1. </span>Récursions dans le domaine logarithmique<a class="headerlink" href="#recursions-dans-le-domaine-logarithmique" title="Permalink to this headline">#</a></h3>
<p>En utilisant les définitions ci-dessus, après un change changement de variable, il vient</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\tilde{\alpha}_n(s)&amp;\triangleq&amp; \log{(\alpha_n(s))} \nonumber \\
&amp;=\log \sum_{s'}{\exp{(\tilde{\alpha}_{n-1}(s')+\tilde{\gamma}_n(s',s))}}  \nonumber\\
&amp;  \nonumber \\
\tilde{\beta}_{n-1}(s')&amp;\triangleq&amp; \log{(\beta_n(s'))} \nonumber \\
&amp;=\log \sum_{s}{\exp{(\tilde{\beta}_{n}(s)+\tilde{\gamma}_n(s',s))}} \nonumber\\\\
&amp;  \nonumber
\end{aligned}\end{split}\]</div>
</section>
<section id="calcul-de-l-u-n">
<h3><span class="section-number">3.4.3.2. </span>Calcul de <span class="math notranslate nohighlight">\(L(u_n)\)</span><a class="headerlink" href="#calcul-de-l-u-n" title="Permalink to this headline">#</a></h3>
<div class="math notranslate nohighlight">
\[\begin{aligned}
L(u_n) = \log{(\sum_{\mathcal{S}^{+}}{\exp{(\tilde{\alpha}_{n-1}(s')+\tilde{\gamma}_n(s',s)+\tilde{\beta}_{n}(s))}})}-\log{(\sum_{\mathcal{S}^{-}}{\exp{(\tilde{\alpha}_{n-1}(s')+\tilde{\gamma}_n(s',s)+\tilde{\beta}_{n}(s))}})} \nonumber
\end{aligned}\]</div>
</section>
<section id="l-operateur-max">
<h3><span class="section-number">3.4.3.3. </span>L’opérateur <span class="math notranslate nohighlight">\(\max^*\)</span><a class="headerlink" href="#l-operateur-max" title="Permalink to this headline">#</a></h3>
<p>On définit ici un opérateur qui permettra de réécrire les équations précédentes et et d’en déduire des algorithmes faibles complexité. On
définit l’opérateur <span class="math notranslate nohighlight">\(\max^*{(x,y)}\)</span> comme suit :</p>
<div class="proof definition admonition" id="definition-3">
<p class="admonition-title"><span class="caption-number">Definition 3.6 </span> (Opérateur <span class="math notranslate nohighlight">\(max^*\)</span>)</p>
<section class="definition-content" id="proof-content">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
max^*{(x,y)}&amp; \triangleq &amp; \log{\left( e^x+e^y \right)} \nonumber\\
&amp;=&amp; \max{(x,y)} - \log{(1+e^{-|x-y|})} 
\end{aligned}\end{split}\]</div>
</section>
</div><p>Cette définition dérive directement du fait que l’on peut écrire <span class="math notranslate nohighlight">\(\max{(x,y)}\)</span> comme suit</p>
<div class="math notranslate nohighlight">
\[\max{(x,y)} = \log{\left( \frac{e^x+e^y}{1+e^{-|x-y|}}\right)}\]</div>
<p>De la définition de l’opérateur, on peut déduire la propriété suivante :</p>
<div class="proof property admonition" id="property-4">
<p class="admonition-title"><span class="caption-number">Property 3.3 </span></p>
<section class="property-content" id="proof-content">
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
max^*{(x,y,z)}&amp; \triangleq &amp; \log{\left( e^x+e^y +e^z\right)} \nonumber\\
&amp;=&amp; \max^*(\max^*{(x,y)},z)
\end{aligned}\end{split}\]</div>
</section>
</div><p>Cette expression se généralise à un nombre de termes quelconque.</p>
</section>
<section id="algorithme-log-map">
<h3><span class="section-number">3.4.3.4. </span>Algorithme Log-MAP<a class="headerlink" href="#algorithme-log-map" title="Permalink to this headline">#</a></h3>
<p>A partir des expressions précédentes, on peut alors donner une version de l’agorithme MAP dans le domaine logarithmique.</p>
<div class="proof algorithm admonition" id="algorithm-5">
<p class="admonition-title"><span class="caption-number">Algorithm 3.3 </span> (Algorithme Log-MAP)</p>
<section class="algorithm-content" id="proof-content">
<ol class="simple">
<li><p><strong>Initialisation (avec fermeture treillis):</strong></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    \tilde{\alpha}_{0}(0) = 0 &amp;,&amp; \alpha_{0}(s) = - \infty \; \mathrm{sinon} \\
    \nonumber \\
    \beta_{L}(0) = 0 &amp;,&amp; \beta_{L}(s) = -\infty \; \mathrm{sinon}
    \end{aligned}\end{split}\]</div>
<ol>
<li><p><strong>Phase forward-backward :</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    \forall n=1, \cdots, L-1, \; \tilde{\alpha}_n(s)&amp;=&amp; {\max_{s'}}^*{(\tilde{\alpha}_{n-1}(s')+\tilde{\gamma}_n(s',s))} \\
    \forall n=L-1, \cdots, 1, \; \tilde{\beta}_{n-1}(s')&amp;=&amp; {\max_{s}}^*{(\tilde{\beta}_{n}(s)+\tilde{\gamma}_n(s',s))}
    \end{aligned}\end{split}\]</div>
</li>
<li><p><strong>Calcul de <span class="math notranslate nohighlight">\(L(u_n)\)</span>:</strong> <span class="math notranslate nohighlight">\(\forall n=1, \cdots, K\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    L(u_n) &amp;=&amp; {\max_{\mathcal{S}^{+}}}^*{\left(\tilde{\alpha}_{n-1}(s')+\tilde{\gamma}_n(s',s)+\tilde{\beta}_{n}(s)\right)} \nonumber \\ &amp; &amp;-{\max_{\mathcal{S}^{-}}}^*{\left(\tilde{\alpha}_{n-1}(s')+\tilde{\gamma}_n(s',s)+\tilde{\beta}_{n}(s)\right)}
    \end{aligned}\end{split}\]</div>
<p>où     <span class="math notranslate nohighlight">\(\max_{\mathcal{S}^{x}}^*{(.)}\triangleq \sum_{\mathcal{S}^{x}}{\exp{(.)}}\)</span></p>
</li>
</ol>
</section>
</div><p>D’un point de vue pratique, cette algorithme est implémenté d’une manière simplifié en utilisant l’opérateur <span class="math notranslate nohighlight">\(\max(.)\)</span> et utilisation de
lookup table pour approximé le terme correctif.</p>
</section>
<section id="algorithme-max-log-map">
<h3><span class="section-number">3.4.3.5. </span>Algorithme Max-Log-MAP<a class="headerlink" href="#algorithme-max-log-map" title="Permalink to this headline">#</a></h3>
<p>On peut réduire la complexité du Log-MaP en considérant le simple remplacement de l’opérateur <span class="math notranslate nohighlight">\({\max}^*(.)\)</span> par l’opérateur <span class="math notranslate nohighlight">\(\max(.)\)</span>. On néglige alors le terme correctif.</p>
<div class="proof algorithm admonition" id="algorithm-6">
<p class="admonition-title"><span class="caption-number">Algorithm 3.4 </span> (Algorithme Max-Log-MAP)</p>
<section class="algorithm-content" id="proof-content">
<ol class="simple">
<li><p><strong>Initialisation (avec fermeture treillis):</strong></p></li>
</ol>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    \tilde{\alpha}_{0}(0) = 0 &amp;,&amp; \alpha_{0}(s) = - \infty \; \mathrm{sinon} \\
    \nonumber \\
    \beta_{L}(0) = 0 &amp;,&amp; \beta_{L}(s) = -\infty \; \mathrm{sinon}
    \end{aligned}\end{split}\]</div>
<ol>
<li><p><strong>Phase forward-backward :</strong></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    \forall n=1, \cdots, L-1, \; \tilde{\alpha}_n(s)&amp;=&amp; {\max_{s'}}{(\tilde{\alpha}_{n-1}(s')+\tilde{\gamma}_n(s',s))} \\
    \forall n=L-1, \cdots, 1, \; \tilde{\beta}_{n-1}(s')&amp;=&amp; {\max_{s}}{(\tilde{\beta}_{n}(s)+\tilde{\gamma}_n(s',s))}
    \end{aligned}\end{split}\]</div>
</li>
<li><p><strong>Calcul de <span class="math notranslate nohighlight">\(L(u_n)\)</span>:</strong> <span class="math notranslate nohighlight">\(\forall n=1, \cdots, K\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
    L(u_n) &amp;=&amp; {\max_{\mathcal{S}^{+}}}{\left(\tilde{\alpha}_{n-1}(s')+\tilde{\gamma}_n(s',s)+\tilde{\beta}_{n}(s)\right)} \nonumber \\ &amp; &amp;-{\max_{\mathcal{S}^{-}}}{\left(\tilde{\alpha}_{n-1}(s')+\tilde{\gamma}_n(s',s)+\tilde{\beta}_{n}(s)\right)}
    \end{aligned}\end{split}\]</div>
</li>
</ol>
</section>
</div></section>
<section id="log-map-log-bcjr-cas-gaussien">
<h3><span class="section-number">3.4.3.6. </span>Log-MAP (log-BCJR) : cas Gaussien<a class="headerlink" href="#log-map-log-bcjr-cas-gaussien" title="Permalink to this headline">#</a></h3>
<p>Dans le cas Gaussien, on peut instancier la métrique de branche comme
suit :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}
\tilde{\gamma}_n(s',s)&amp;=\log{(\gamma_n(s',s))} \nonumber \\
&amp;=\log(\pi(u_n))-n_c/2*\log{(2\pi \sigma^2)}-\frac{1}{2 \sigma^2} \sum_{m=1}^{n_c}{|y_n^{(m)}-c_n^{(m)}(s',s)|^2} \nonumber
\end{aligned}\end{split}\]</div>
<p>en se réferant au critère MAP final, la constante peut-être supprimée.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ch3sec3.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">3.3. </span>Décodage par Maximum de Vraisemblance</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="ch4intro.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Concaténation de codes en treillis : Turbo-codes</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By C. Poulliat<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>